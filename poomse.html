<!DOCTYPE HTML>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Poomse - SP Training TaeKwonDo</title>
    <link rel="stylesheet" href="assets/css/style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script defer src="assets/js/script.js"></script>
</head>
<body class="subpage">

    <!-- Header -->
    <header class="header">
        <div class="logo">SP Training TaeKwonDo</div>
        <button class="menu-toggle" aria-label="Menu">‚ò∞</button>
        <nav>
            <ul>
                <li><a href="index.html">Accueil</a></li>
                <li><a href="bases.html">Les Bases</a></li>
                <li><a href="poomse.html">Poomse</a></li>
                <li><a href="vocabulaire.html">Vocabulaire</a></li>
                <li><a href="quiz.html">Quiz</a></li>
            </ul>
        </nav>
    </header>

    <!-- Contenu principal -->
    <div id="main" class="container">
        <section class="wrapper style1">
            <div class="inner">
                <header class="section-title">
                    <h2>Les Poomse</h2>
                    <p>D√©couvrez les 8 poomse du Taekwondo avec leurs vid√©os explicatives et leurs documents PDF.</p>
                </header>

                <!-- Grid des poomse -->
                <div class="document-grid">
                    <div class="document-card active" data-pdf="pdf/poomse/Poomse1.pdf" data-video="https://www.youtube.com/embed/j8ee61tXa2s">
                        <div class="document-icon">1Ô∏è‚É£</div>
                        <h3>Poomse 1</h3>
                        <span class="btn">üìñ Voir</span>
                    </div>

                    <div class="document-card" data-pdf="pdf/poomse/Poomse2.pdf" data-video="https://www.youtube.com/embed/n-6LhzUtHzM">
                        <div class="document-icon">2Ô∏è‚É£</div>
                        <h3>Poomse 2</h3>
                        <span class="btn">üìñ Voir</span>
                    </div>

                    <div class="document-card" data-pdf="pdf/poomse/Poomse3.pdf" data-video="https://www.youtube.com/embed/q2FQ3Z6nmD4">
                        <div class="document-icon">3Ô∏è‚É£</div>
                        <h3>Poomse 3</h3>
                        <span class="btn">üìñ Voir</span>
                    </div>

                    <div class="document-card" data-pdf="pdf/poomse/Poomse4.pdf" data-video="https://www.youtube.com/embed/6T6mw1WjC3k">
                        <div class="document-icon">4Ô∏è‚É£</div>
                        <h3>Poomse 4</h3>
                        <span class="btn">üìñ Voir</span>
                    </div>

                    <div class="document-card" data-pdf="pdf/poomse/Poomse5.pdf" data-video="https://www.youtube.com/embed/QQp60pTET14">
                        <div class="document-icon">5Ô∏è‚É£</div>
                        <h3>Poomse 5</h3>
                        <span class="btn">üìñ Voir</span>
                    </div>

                    <div class="document-card" data-pdf="pdf/poomse/Poomse6.pdf" data-video="https://www.youtube.com/embed/otUbB-vgdNQ">
                        <div class="document-icon">6Ô∏è‚É£</div>
                        <h3>Poomse 6</h3>
                        <span class="btn">üìñ Voir</span>
                    </div>

                    <div class="document-card" data-pdf="pdf/poomse/Poomse7.pdf" data-video="https://www.youtube.com/embed/psqyXqlBhy4">
                        <div class="document-icon">7Ô∏è‚É£</div>
                        <h3>Poomse 7</h3>
                        <span class="btn">üìñ Voir</span>
                    </div>

                    <div class="document-card" data-pdf="pdf/poomse/Poomse8.pdf" data-video="https://www.youtube.com/embed/Bw-5kZFtfos">
                        <div class="document-icon">8Ô∏è‚É£</div>
                        <h3>Poomse 8</h3>
                        <span class="btn">üìñ Voir</span>
                    </div>
                </div>

                <!-- Zone d'affichage du PDF -->
                <div class="pdf-container">
                    <div id="pdf-viewer-container" style="display: block;">
                        <canvas id="pdf-canvas"></canvas>
                        <div id="pdf-controls" style="margin-top: 15px; text-align: center; display: flex; justify-content: center; gap: 10px; flex-wrap: wrap;">
                            <button id="pdf-prev" class="pdf-btn">‚Üê Pr√©c√©dent</button>
                            <span id="pdf-page-info" style="color: white; padding: 8px 15px; display: inline-block;">Page 1 / 1</span>
                            <button id="pdf-next" class="pdf-btn">Suivant ‚Üí</button>
                            <button id="pdf-zoom-out" class="pdf-btn">üîç-</button>
                            <button id="pdf-zoom-in" class="pdf-btn">üîç+</button>
                        </div>
                    </div>
                    <iframe id="pdf-viewer-fallback" src="pdf/poomse/Poomse1.pdf#toolbar=0" frameborder="0" style="display: none;"></iframe>
                    
                    <!-- Zone vid√©o YouTube -->
                    <div class="video-container" style="margin-top: 30px;">
                        <h3 style="margin-bottom: 15px;">Vid√©o Explicative</h3>
                        <iframe id="video-frame" src="https://www.youtube.com/embed/j8ee61tXa2s" frameborder="0" allowfullscreen></iframe>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Footer -->
    <footer>
        <p>&copy; 2025 DraGonKill25 - Tous droits r√©serv√©s.</p>
    </footer>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const videoFrame = document.getElementById("video-frame");
            const pdfContainer = document.querySelector(".pdf-container");
            const documentCards = document.querySelectorAll(".document-card");
            
            // Configuration PDF.js
            if (typeof pdfjsLib !== 'undefined') {
                pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
            }

            // Variables pour le visualiseur PDF
            let pdfDoc = null;
            let pageNum = 1;
            let pageRendering = false;
            let pageNumPending = null;
            let scale = window.innerWidth <= 768 ? 1.0 : 1.5;
            const canvas = document.getElementById('pdf-canvas');

            // Fonction pour convertir une URL YouTube en format embed
            function convertToEmbedUrl(url) {
                if (!url) return url;
                
                if (url.includes('youtube.com/embed/')) {
                    return url;
                }
                
                if (url.includes('youtube.com/watch?v=')) {
                    const videoId = url.split('v=')[1].split('&')[0];
                    return `https://www.youtube.com/embed/${videoId}`;
                }
                
                if (url.includes('youtu.be/')) {
                    const videoId = url.split('youtu.be/')[1].split('?')[0];
                    return `https://www.youtube.com/embed/${videoId}`;
                }
                
                return url;
            }

            // Fonction pour rendre une page PDF
            function renderPage(num) {
                if (!canvas || !pdfDoc) return;
                
                pageRendering = true;
                const ctx = canvas.getContext('2d');
                
                pdfDoc.getPage(num).then(function(page) {
                    const viewport = page.getViewport({scale: scale});
                    canvas.height = viewport.height;
                    canvas.width = viewport.width;

                    const renderContext = {
                        canvasContext: ctx,
                        viewport: viewport
                    };
                    const renderTask = page.render(renderContext);

                    renderTask.promise.then(function() {
                        pageRendering = false;
                        if (pageNumPending !== null) {
                            renderPage(pageNumPending);
                            pageNumPending = null;
                        }
                        updatePageInfo();
                    });
                });
            }

            // Fonction pour mettre √† jour les informations de page
            function updatePageInfo() {
                const pageInfo = document.getElementById('pdf-page-info');
                if (pageInfo && pdfDoc) {
                    pageInfo.textContent = `Page ${pageNum} / ${pdfDoc.numPages}`;
                }
                
                // Afficher/masquer les boutons de navigation
                const prevBtn = document.getElementById('pdf-prev');
                const nextBtn = document.getElementById('pdf-next');
                if (prevBtn) prevBtn.disabled = pageNum <= 1;
                if (nextBtn) nextBtn.disabled = pageNum >= pdfDoc.numPages;
            }

            // Fonction pour charger un PDF
            function loadPDF(url) {
                const pdfViewerContainer = document.getElementById('pdf-viewer-container');
                const pdfViewerFallback = document.getElementById('pdf-viewer-fallback');
                
                if (!pdfViewerContainer || !pdfViewerFallback) return;
                
                // Utiliser PDF.js si disponible, sinon fallback vers iframe
                if (typeof pdfjsLib === 'undefined') {
                    pdfViewerContainer.style.display = 'none';
                    pdfViewerFallback.src = url + "#toolbar=0";
                    pdfViewerFallback.style.display = 'block';
                    return;
                }
                
                // Utiliser PDF.js (fonctionne sur PC et mobile)
                pdfViewerFallback.style.display = 'none';
                pdfViewerContainer.style.display = 'block';
                
                pdfjsLib.getDocument(url).promise.then(function(pdf) {
                    pdfDoc = pdf;
                    pageNum = 1;
                    renderPage(pageNum);
                }).catch(function(error) {
                    console.error('Erreur lors du chargement du PDF:', error);
                    // Fallback vers iframe en cas d'erreur
                    pdfViewerContainer.style.display = 'none';
                    pdfViewerFallback.src = url + "#toolbar=0";
                    pdfViewerFallback.style.display = 'block';
                });
            }

            // Gestionnaires d'√©v√©nements pour les contr√¥les PDF
            document.getElementById('pdf-prev').addEventListener('click', function() {
                if (pageNum <= 1) return;
                pageNum--;
                renderPage(pageNum);
            });

            document.getElementById('pdf-next').addEventListener('click', function() {
                if (pageNum >= pdfDoc.numPages) return;
                pageNum++;
                renderPage(pageNum);
            });

            document.getElementById('pdf-zoom-out').addEventListener('click', function() {
                if (scale <= 0.5) return;
                scale -= 0.25;
                renderPage(pageNum);
            });

            document.getElementById('pdf-zoom-in').addEventListener('click', function() {
                if (scale >= 3) return;
                scale += 0.25;
                renderPage(pageNum);
            });

            // Charger le PDF initial
            loadPDF('pdf/poomse/Poomse1.pdf');

            documentCards.forEach(card => {
                card.addEventListener("click", function() {
                    const pdfUrl = this.getAttribute("data-pdf");
                    let videoUrl = this.getAttribute("data-video");

                    if (pdfUrl) {
                        loadPDF(pdfUrl);
                        
                        if (window.innerWidth <= 768) {
                            setTimeout(() => {
                                window.scrollTo({ 
                                    top: 0,
                                    behavior: 'smooth'
                                });
                            }, 100);
                        }
                    }

                    if (videoUrl) {
                        videoUrl = convertToEmbedUrl(videoUrl);
                        videoFrame.src = videoUrl;
                    }

                    documentCards.forEach(c => c.classList.remove("active"));
                    this.classList.add("active");
                });
            });
        });
    </script>

</body>
</html>

